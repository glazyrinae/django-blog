{% extends "base/_main.html" %}
{% block title %}
    {% if category %}
        {{ category }}
    {% else %}
        {{ title }}
    {% endif %}
{% endblock %}

{% block content %}
    {% load my_filters %}

    <section class="cta-section theme-bg-light py-5">
        <div class="container text-center single-col-max-width">
            <h2 class="heading">–í –¥–∞–Ω–Ω–æ–º –±–ª–æ–≥–µ –¥–æ—Å—Ç—É–ø–Ω–æ {{ cnt_posts|plural }} –Ω–∞ —Ä–∞–∑–Ω—ã–µ —Ç–µ–º—ã</h2>
        </div>
    </section>

    <section class="blog-list px-3 py-5 p-md-5">
        <div class="container single-col-max-width">

            <!-- üîΩ –í—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ -->
            <div class="d-flex flex-wrap align-items-center justify-content-between mb-4 gap-2">
                <div class="fw-bold">–°–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ: {{order_by}}</div>
                <div class="dropdown">
                    <button class="btn btn-outline-secondary dropdown-toggle" 
                            type="button" 
                            id="sortDropdown" 
                            data-bs-toggle="dropdown" 
                            aria-expanded="false">
                        {% if order_by == '-created' or not order_by %}
                            –°–Ω–∞—á–∞–ª–∞ –Ω–æ–≤—ã–µ
                        {% elif order_by == 'created' %}
                            –°–Ω–∞—á–∞–ª–∞ —Å—Ç–∞—Ä—ã–µ
                        {% elif order_by == 'title' %}
                            –ü–æ –Ω–∞–∑–≤–∞–Ω–∏—é (–ê‚Äì–Ø)
                        {% elif order_by == '-title' %}
                            –ü–æ –Ω–∞–∑–≤–∞–Ω–∏—é (–Ø‚Äì–ê)
                        {% else %}
                            –í—ã–±–µ—Ä–∏—Ç–µ...
                        {% endif %}
                    </button>
                    <ul class="dropdown-menu" aria-labelledby="sortDropdown">
                        <li><a class="dropdown-item {% if order_by == '-created' or not order_by %}active{% endif %}" 
                               href="?order_by=-created">–°–Ω–∞—á–∞–ª–∞ –Ω–æ–≤—ã–µ</a></li>
                        <li><a class="dropdown-item {% if order_by == 'created' %}active{% endif %}" 
                               href="?order_by=created">–°–Ω–∞—á–∞–ª–∞ —Å—Ç–∞—Ä—ã–µ</a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li><a class="dropdown-item {% if order_by == 'title' %}active{% endif %}" 
                               href="?order_by=title">–ü–æ –Ω–∞–∑–≤–∞–Ω–∏—é (–ê‚Äì–Ø)</a></li>
                        <li><a class="dropdown-item {% if order_by == '-title' %}active{% endif %}" 
                               href="?order_by=-title">–ü–æ –Ω–∞–∑–≤–∞–Ω–∏—é (–Ø‚Äì–ê)</a></li>
                        <!-- –î–æ–±–∞–≤—å—Ç–µ –¥—Ä—É–≥–∏–µ –æ–ø—Ü–∏–∏ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ -->
                    </ul>
                </div>
            </div>
            <!-- üîº –ö–æ–Ω–µ—Ü –≤—ã–ø–∞–¥–∞—é—â–µ–≥–æ —Å–ø–∏—Å–∫–∞ -->

            {% for post in items %}
                <div class="item mb-5">
                    <div class="row g-3 g-xl-0">
                        <div class="col-2 col-xl-3">
                            {% if post.images and post.get_path_image_thumbnail %}
                                <img class="img-fluid post-thumb rounded"
                                    src="{{ MEDIA_URL }}{{ post.get_path_image_thumbnail }}"
                                    alt="{{ post.title }}" />
                            {% else %}
                                <svg class="post-thumb-placeholder d-block w-100 h-auto" viewBox="0 0 200 120" xmlns="http://www.w3.org/2000/svg">
                                    <rect width="100%" height="100%" fill="#f8f9fa"/>
                                    <path d="M50 50 L150 50 L100 90 Z" fill="#6c757d" opacity="0.3"/>
                                    <circle cx="100" cy="50" r="20" fill="#6c757d" opacity="0.5"/>
                                    <text x="100" y="110" text-anchor="middle" fill="#6c757d" font-size="12">DL Blog</text>
                                </svg>
                            {% endif %}
                        </div>
                        <div class="col">
                            <h3 class="title mb-1">
                                <a class="text-link" href="{{ post.get_absolute_url }}">{{ post.title }}</a>
                            </h3>
                            <div class="meta mb-1">
                                <span class="date">{{ post.publish }}</span>
                            </div>
                            <div class="intro">{{ post.body|strip_markdown|truncatewords:30|linebreaks }}</div>
                            <a class="text-link" href="{{ post.get_absolute_url }}">–ß–∏—Ç–∞—Ç—å —Å—Ç–∞—Ç—å—é &rarr;</a>
                        </div>
                    </div>
                </div>
            {% empty %}
                <div class="alert alert-info" role="alert">
                    –ü–æ—Å—Ç–æ–≤ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ.
                </div>
            {% endfor %}

            {% include "base/_pagination.html" with page=items order_by=order_by %}
        </div>
    </section>

    {% load search_tags %}
    {% render_search_panel config_name="–ü–æ–∏—Å–∫ –ø–æ –ø–æ–ª—è–º" %}
{% endblock %}