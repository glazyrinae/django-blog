{% load sekizai_tags static %}

{% addtoblock "css" %}
    <link rel="stylesheet" href="{% static "css/src/nouislider.min.css" %}">
    <link rel="stylesheet" href="{% static "css/range.css" %}">
{% endaddtoblock %}
{% addtoblock "js_footer" %}
    <script src="{% static 'js/src/nouislider.min.js' %}"></script>
    <script src="{% static 'js/range.js' %}"></script>
{% endaddtoblock %}

<div class="accordion accordion-flush mb-2 range-accordion">
    <div class="accordion-item">
        <h2 class="accordion-header" id="range-heading-{{ field.id }}">
            <button class="accordion-button collapsed py-2"
                    type="button"
                    data-bs-toggle="collapse"
                    data-bs-target="#range-collapse-{{ field.id }}"
                    aria-expanded="false"
                    aria-controls="range-collapse-{{ field.id }}">
                {{ field.label }}
            </button>
        </h2>
        <div id="range-collapse-{{ field.id }}"
             class="accordion-collapse collapse"
             aria-labelledby="range-heading-{{ field.id }}">
            <div class="accordion-body pt-2">
                <div class="range-slider-wrapper mb-0"
                    data-field-name="{{ field.field_name }}"
                    data-min="{{ field.min_value|default:0 }}"
                    data-max="{{ field.max_value|default:100 }}"
                    data-step="{{ field.step|default:1 }}">
                    
                    <!-- Контейнер для слайдера -->
                    <div class="slider-container mb-3">
                        <!-- Сам слайдер (ДОЛЖЕН БЫТЬ ПУСТОЙ DIV) -->
                        <div class="slider" id="slider-{{ field.id }}"></div>
                        <!-- Поля для ручного ввода -->
                        <div class="row" style="margin-top: 35px;">
                            <div class="col">
                                <div class="input-group input-group-sm">
                                    <span class="input-group-text">От</span>
                                    <input type="number" 
                                        class="form-control slider-min-input" 
                                        min="{{ field.min_value|default:0 }}"
                                        max="{{ field.max_value|default:100 }}"
                                        step="{{ field.step|default:1 }}">
                                </div>
                            </div>
                            <div class="col">
                                <div class="input-group input-group-sm">
                                    <span class="input-group-text">До</span>
                                    <input type="number" 
                                        class="form-control slider-max-input" 
                                        min="{{ field.min_value|default:0 }}"
                                        max="{{ field.max_value|default:100 }}"
                                        step="{{ field.step|default:1 }}">
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Скрытые поля -->
                    <input type="hidden" name="{{ field.field_name }}_min" class="slider-hidden-min">
                    <input type="hidden" name="{{ field.field_name }}_max" class="slider-hidden-max">
                </div>
            </div>
        </div>
    </div>
</div>
